apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-config
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
data:
  {{- if .Values.config.postgresql.enabled }}
  # PostgreSQL configuration
  postgres-host: {{ .Values.config.postgresql.host | quote }}
  postgres-port: {{ .Values.config.postgresql.port | quote }}
  postgres-database: {{ .Values.config.postgresql.database | quote }}
  postgres-sslmode: {{ .Values.config.postgresql.sslmode | quote }}
  {{- end }}
  
  {{- if .Values.config.cassandra.enabled }}
  # Apache Cassandra configuration
  cassandra-hosts: {{ .Values.config.cassandra.hosts | quote }}
  cassandra-port: {{ .Values.config.cassandra.port | quote }}
  {{- if .Values.config.cassandra.keyspace }}
  cassandra-keyspace: {{ .Values.config.cassandra.keyspace | quote }}
  {{- end }}
  cassandra-datacenter: {{ .Values.config.cassandra.datacenter | quote }}
  cassandra-use-ssl: {{ .Values.config.cassandra.useSsl | quote }}
  {{- end }}
  
  {{- if .Values.config.blobStorage.enabled }}
  # Azure Blob Storage configuration
  blob-account-name: {{ .Values.config.blobStorage.accountName | quote }}
  blob-container-name: {{ .Values.config.blobStorage.containerName | quote }}
  blob-endpoint-suffix: {{ .Values.config.blobStorage.endpointSuffix | default "core.windows.net" | quote }}
  {{- end }}
  
  {{- if .Values.config.openai.enabled }}
  # Azure OpenAI configuration
  azure-openai-endpoint: {{ .Values.config.openai.endpoint | quote }}
  azure-openai-deployment-name: {{ .Values.config.openai.deploymentName | quote }}
  azure-openai-api-version: {{ .Values.config.openai.apiVersion | default "2024-02-01" | quote }}
  {{- if .Values.config.openai.embeddingDeployment }}
  azure-openai-embedding-deployment: {{ .Values.config.openai.embeddingDeployment | quote }}
  {{- end }}
  # Generic OpenAI configuration
  {{- if .Values.config.openai.openaiBaseUrl }}
  openai-base-url: {{ .Values.config.openai.openaiBaseUrl | quote }}
  {{- end }}
  {{- if .Values.config.openai.openaiModelName }}
  openai-model-name: {{ .Values.config.openai.openaiModelName | quote }}
  {{- end }}
  {{- if .Values.config.openai.openaiEmbeddingModel }}
  openai-embedding-model: {{ .Values.config.openai.openaiEmbeddingModel | quote }}
  {{- end }}
  # Test configuration
  openai-timeout: {{ .Values.config.openai.timeout | default 30 | quote }}
  test-completion: {{ .Values.config.openai.testCompletion | default true | quote }}
  test-embedding: {{ .Values.config.openai.testEmbedding | default true | quote }}
  {{- if .Values.config.openai.customPrompt }}
  openai-custom-prompt: {{ .Values.config.openai.customPrompt | quote }}
  {{- end }}
  {{- if .Values.config.openai.customSystemMessage }}
  openai-custom-system-message: {{ .Values.config.openai.customSystemMessage | quote }}
  {{- end }}
  {{- end }}
  
  {{- if .Values.config.documentIntelligence.enabled }}
  # Azure Document Intelligence configuration
  azure-doc-intel-endpoint: {{ .Values.config.documentIntelligence.endpoint | quote }}
  azure-doc-intel-model: {{ .Values.config.documentIntelligence.model | quote }}
  {{- if .Values.config.documentIntelligence.testUrl }}
  azure-doc-intel-test-url: {{ .Values.config.documentIntelligence.testUrl | quote }}
  {{- end }}
  doc-intel-timeout: {{ .Values.config.documentIntelligence.timeout | default 60 | quote }}
  {{- end }}
  
  {{- if .Values.config.ssl.enabled }}
  # SSL certificate testing URLs
  ssl-test-urls: {{ .Values.config.ssl.testUrls | quote }}
  ssl-connect-timeout: {{ .Values.config.ssl.connectTimeout | quote }}
  ssl-warning-days: {{ .Values.config.ssl.warningDays | quote }}
  {{- end }}
  
  {{- if .Values.config.minio.enabled }}
  # Minio S3-compatible storage configuration
  minio-endpoint-url: {{ .Values.config.minio.endpointUrl | quote }}
  minio-bucket-name: {{ .Values.config.minio.bucketName | quote }}
  minio-secure: {{ .Values.config.minio.secure | quote }}
  {{- end }}
  
  {{- if .Values.config.s3.enabled }}
  # Amazon S3 storage configuration
  aws-region: {{ .Values.config.s3.region | quote }}
  s3-bucket-name: {{ .Values.config.s3.bucketName | quote }}
  {{- if .Values.config.s3.endpointUrl }}
  s3-endpoint-url: {{ .Values.config.s3.endpointUrl | quote }}
  {{- end }}
  {{- end }}
  
  {{- if .Values.config.embeddings.enabled }}
  # Embedding model configuration
  embedding-base-url: {{ .Values.config.embeddings.baseUrl | quote }}
  embedding-model-name: {{ .Values.config.embeddings.modelName | quote }}
  {{- if .Values.config.embeddings.customHeaders }}
  embedding-custom-headers: {{ .Values.config.embeddings.customHeaders | quote }}
  {{- end }}
  {{- end }}
  
  {{- if .Values.config.llama.enabled }}
  # Llama model configuration
  llama-base-url: {{ .Values.config.llama.baseUrl | quote }}
  llama-model-name: {{ .Values.config.llama.modelName | quote }}
  llama-max-tokens: {{ .Values.config.llama.maxTokens | quote }}
  llama-temperature: {{ .Values.config.llama.temperature | quote }}
  llama-timeout: {{ .Values.config.llama.timeout | quote }}
  {{- end }}

  {{- if .Values.config.gpu.enabled }}
  # GPU detection configuration
  gpu-required: {{ .Values.config.gpu.required | quote }}
  {{- end }}

  # Kubernetes configuration
  storage-class: {{ .Values.config.kubernetes.storageClass | quote }}
  test-pvc-size: {{ .Values.config.kubernetes.testPvcSize | quote }}