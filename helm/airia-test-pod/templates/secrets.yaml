apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-auth
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  username: {{ .Values.config.auth.username | b64enc | quote }}
  password: {{ .Values.config.auth.password | b64enc | quote }}
  secret-key: {{ .Values.config.auth.secretKey | b64enc | quote }}

{{- if .Values.config.postgresql.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-postgres
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  username: {{ .Values.config.postgresql.username | b64enc | quote }}
  password: {{ .Values.config.postgresql.password | b64enc | quote }}
{{- end }}

{{- if and .Values.config.cassandra.enabled .Values.config.cassandra.username }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-cassandra
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  username: {{ .Values.config.cassandra.username | b64enc | quote }}
  password: {{ .Values.config.cassandra.password | b64enc | quote }}
{{- end }}

{{- if .Values.config.blobStorage.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-blob
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  account-key: {{ .Values.config.blobStorage.accountKey | b64enc | quote }}
{{- end }}

{{- if .Values.config.openai.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-openai
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  api-key: {{ .Values.config.openai.apiKey | b64enc | quote }}
  {{- if .Values.config.openai.openaiApiKey }}
  openai-api-key: {{ .Values.config.openai.openaiApiKey | b64enc | quote }}
  {{- end }}
{{- end }}

{{- if .Values.config.documentIntelligence.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-doc-intel
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  api-key: {{ .Values.config.documentIntelligence.apiKey | b64enc | quote }}
{{- end }}

{{- if .Values.config.minio.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-minio
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  access-key: {{ .Values.config.minio.accessKey | b64enc | quote }}
  secret-key: {{ .Values.config.minio.secretKey | b64enc | quote }}
{{- end }}

{{- if .Values.config.s3.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-s3
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  access-key-id: {{ .Values.config.s3.accessKeyId | b64enc | quote }}
  secret-access-key: {{ .Values.config.s3.secretAccessKey | b64enc | quote }}
  {{- if .Values.config.s3.sessionToken }}
  session-token: {{ .Values.config.s3.sessionToken | b64enc | quote }}
  {{- end }}
{{- end }}

{{- if .Values.config.embeddings.enabled }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-embeddings
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  api-key: {{ .Values.config.embeddings.apiKey | b64enc | quote }}
{{- end }}

{{- if or (and .Values.config.ollama .Values.config.ollama.enabled .Values.config.ollama.apiKey) (and .Values.config.llama .Values.config.llama.enabled .Values.config.llama.apiKey) }}
{{- $ollamaConfig := .Values.config.ollama | default .Values.config.llama }}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "airia-test-pod.fullname" . }}-llama
  namespace: {{ include "airia-test-pod.namespace" . }}
  labels:
    {{- include "airia-test-pod.labels" . | nindent 4 }}
type: Opaque
data:
  api-key: {{ $ollamaConfig.apiKey | b64enc | quote }}
{{- end }}