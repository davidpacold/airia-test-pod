<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - {{ title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', path='/style.css') }}?v={{ version }}">
    <script src="{{ url_for('static', path='/vendor/axios.min.js') }}"></script>
    <script src="{{ url_for('static', path='/critical-extensions.js') }}?v={{ version }}"></script>
    <script src="{{ url_for('static', path='/dashboard.js') }}?v={{ version }}" data-app-version="{{ version }}"></script>
</head>
<body>
    <!-- Notification System -->
    <div class="notification-container" id="notificationContainer" role="alert" aria-live="polite"></div>

    <div class="container">
        <header class="dashboard-header">
            <div>
                <h1>{{ title }}</h1>
                <div class="connection-status">
                    <span class="status-indicator" id="connectionIndicator"></span>
                    <span id="connectionStatus">Manual refresh mode</span>
                    <span class="real-time-badge">READY</span>
                </div>
            </div>
            <div class="user-info">
                <span>Welcome, <strong>{{ username }}</strong></span>
                <a href="/logout" class="logout-button">Logout</a>
            </div>
        </header>

        <main>
            <div class="welcome-section">
                <h2>Infrastructure Readiness Dashboard</h2>
                <p>Validate your infrastructure before deploying the main application. Run tests to check connectivity to all required services.</p>
                <button class="run-tests-button" onclick="runAllTests()" id="runAllTestsBtn" aria-label="Run all infrastructure tests">Run All Tests</button>
            </div>

            <!-- Storage Tests -->
            <div class="test-section">
                <h2 class="section-title">Storage Tests</h2>
                <div class="test-grid">
                    <div class="test-card" id="blobstorage-card">
                        <h3>Azure Blob Storage</h3>
                        <p>Tests authentication and file operations</p>
                        <span class="test-status ready" id="blobstorage-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('blobstorage')" id="blobstorage-btn">Run Test</button>
                        <div class="test-details" id="blobstorage-details"></div>
                    </div>

                    <div class="test-card" id="s3-card">
                        <h3>Amazon S3 Storage</h3>
                        <p>Tests S3 connectivity and operations</p>
                        <span class="test-status ready" id="s3-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('s3')" id="s3-btn">Run Test</button>
                        <div class="test-details" id="s3-details"></div>
                    </div>

                    <div class="test-card" id="minio-card">
                        <h3>MinIO Storage</h3>
                        <p>Tests S3-compatible storage connectivity</p>
                        <span class="test-status ready" id="minio-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('minio')" id="minio-btn">Run Test</button>
                        <div class="test-details" id="minio-details"></div>
                    </div>
                </div>
            </div>

            <!-- Database Tests -->
            <div class="test-section">
                <h2 class="section-title">Database Tests</h2>
                <div class="test-grid">
                    <div class="test-card" id="postgresqlv2-card">
                        <h3>PostgreSQL Database</h3>
                        <p>Tests connection, databases, and extensions</p>
                        <span class="test-status ready" id="postgresqlv2-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('postgresqlv2')" id="postgresqlv2-btn">Run Test</button>
                        <div class="test-details" id="postgresqlv2-details"></div>
                    </div>

                    <div class="test-card" id="cassandra-card">
                        <h3>Apache Cassandra</h3>
                        <p>Tests connectivity, keyspaces, and cluster health</p>
                        <span class="test-status ready" id="cassandra-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('cassandra')" id="cassandra-btn">Run Test</button>
                        <div class="test-details" id="cassandra-details"></div>
                    </div>
                </div>
            </div>

            <!-- AI & ML Tests -->
            <div class="test-section">
                <h2 class="section-title">AI &amp; Machine Learning Tests</h2>
                <div class="test-grid">
                    <div class="test-card" id="azureopenai-card">
                        <h3>Azure OpenAI</h3>
                        <p>Tests Azure OpenAI endpoint connectivity</p>
                        <span class="test-status ready" id="azureopenai-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('azureopenai')" id="azureopenai-btn">Run Test</button>
                        <div class="test-details" id="azureopenai-details"></div>
                    </div>

                    <div class="test-card" id="openaidirect-card">
                        <h3>OpenAI Direct</h3>
                        <p>Tests OpenAI API connectivity</p>
                        <span class="test-status ready" id="openaidirect-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('openaidirect')" id="openaidirect-btn">Run Test</button>
                        <div class="test-details" id="openaidirect-details"></div>
                    </div>

                    <div class="test-card" id="anthropic-card">
                        <h3>Anthropic Claude</h3>
                        <p>Tests Anthropic API connectivity</p>
                        <span class="test-status ready" id="anthropic-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('anthropic')" id="anthropic-btn">Run Test</button>
                        <div class="test-details" id="anthropic-details"></div>
                    </div>

                    <div class="test-card" id="bedrock-card">
                        <h3>AWS Bedrock</h3>
                        <p>Tests AWS Bedrock AI service</p>
                        <span class="test-status ready" id="bedrock-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('bedrock')" id="bedrock-btn">Run Test</button>
                        <div class="test-details" id="bedrock-details"></div>
                    </div>

                    <div class="test-card" id="gemini-card">
                        <h3>Google Gemini</h3>
                        <p>Tests Google Gemini API connectivity</p>
                        <span class="test-status ready" id="gemini-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('gemini')" id="gemini-btn">Run Test</button>
                        <div class="test-details" id="gemini-details"></div>
                    </div>

                    <div class="test-card" id="mistral-card">
                        <h3>Mistral AI</h3>
                        <p>Tests Mistral API connectivity</p>
                        <span class="test-status ready" id="mistral-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('mistral')" id="mistral-btn">Run Test</button>
                        <div class="test-details" id="mistral-details"></div>
                    </div>

                    <div class="test-card" id="documentintelligence-card">
                        <h3>Document Intelligence</h3>
                        <p>Tests document processing API</p>
                        <span class="test-status ready" id="documentintelligence-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('documentintelligence')" id="documentintelligence-btn">Run Test</button>
                        <div class="test-details" id="documentintelligence-details"></div>
                    </div>
                </div>
            </div>

            <!-- Infrastructure Tests -->
            <div class="test-section">
                <h2 class="section-title">Infrastructure Tests</h2>
                <div class="test-grid">
                    <div class="test-card" id="pvc-card">
                        <h3>Kubernetes PVC</h3>
                        <p>Tests storage class and permissions</p>
                        <span class="test-status ready" id="pvc-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('pvc')" id="pvc-btn">Run Test</button>
                        <div class="test-details" id="pvc-details"></div>
                    </div>

                    <div class="test-card" id="gpu-card">
                        <h3>GPU Detection</h3>
                        <p>Validates GPU availability, driver, and CUDA</p>
                        <span class="test-status ready" id="gpu-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('gpu')" id="gpu-btn">Run Test</button>
                        <div class="test-details" id="gpu-details"></div>
                    </div>

                    <div class="test-card" id="dns-card">
                        <h3>DNS Resolution</h3>
                        <p>Tests DNS resolution for configured hosts</p>
                        <span class="test-status ready" id="dns-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('dns')" id="dns-btn">Run Test</button>
                        <div class="test-details" id="dns-details"></div>
                        <div class="dns-adhoc">
                            <label for="dns-hostname" class="sr-only">Hostname to resolve</label>
                            <input type="text" id="dns-hostname" placeholder="Resolve a hostname..." class="dns-input" aria-label="Hostname to resolve">
                            <button class="test-button test-button-sm" onclick="resolveDns()">Resolve</button>
                            <div id="dns-resolve-result" class="dns-result"></div>
                        </div>
                    </div>

                    <div class="test-card" id="ssl-card">
                        <h3>SSL Certificates</h3>
                        <p>Validates certificate chains and expiry</p>
                        <span class="test-status ready" id="ssl-status">Ready to Test</span>
                        <button class="test-button" onclick="runTest('ssl')" id="ssl-btn">Run Test</button>
                        <div class="test-details" id="ssl-details"></div>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p>Airia Infrastructure Test Pod <span id="version-display">Loading...</span></p>
        </footer>
    </div>
</body>
</html>
